<div class="min-h-screen">
  <!-- Hero Section -->
  <section class="py-16 px-4" style="background-image: url('../../../assets/images/background/ferns.png'); background-size: cover; background-position: center;">
    <div class="max-w-7xl mx-auto">
      <div class="grid lg:grid-cols-2 gap-12 items-center">
        <!-- Left Content -->
        <div class="space-y-8">
          <div class="relative">
            <h1 class="text-2xl md:text-3xl font-bold leading-none">
              Notre raison d’être : le soutien à la culture
              <span class="text-pont-rust font-extrabold leading-none  mt-2"> des artistes accomplis aux jeunes talents.</span>
            </h1>
            <div class="mt-6 text-gray-700 text-md md:text-md space-y-4">
              <p><b>
                Notre ambition a toujours été de soutenir la culture</b> en présentant des artistes plasticiens à la réputation établie, ainsi que de jeunes musiciens de talent issus des excellents Conservatoires Nationaux (CNSM) ou équivalents. Ils et elles ont besoin de se produire pour parfaire leur formation et affiner leur jeu.  <br>
                <b>Notre association organise des concerts toute l’année : </b>
Pour leur permettre de roder leur programme et de développer leur répertoire. 
                
              </p>
              
              <p><b>
                Mais le manoir n’a rien d’une salle de spectacle,</b> l’audience dans l’Atelier y est limitée. La vente des billets ne suffit pas pour financer les cachets et tous les frais… 

                Nous devons faire appel à des institutions et à des aides privées pour financer le projet complet. 
                Vos dons sont les bienvenus, votre choix de participer à notre challenge nous est précieux, nous vous en sommes reconnaissants. 
              </p>

             
              

            </div>
          </div>

          <!-- Action Buttons -->
          <div class="flex flex-col sm:flex-row gap-4">
            <button (click)="donation()" class="bg-pont-rust hover:bg-pont-rust/90 text-white px-8 py-3 text-lg rounded">
              Je soutiens
            </button> 
            <button (click)="becomeMember()" class="border border-pont-green text-pont-green hover:bg-pont-green hover:text-white px-8 py-3 text-lg rounded bg-transparent">
              Devenir membre
            </button>
          </div>
        </div>

        <!-- Right Image -->
        <div class="relative">
          <div class="relative rounded-md overflow-hidden shadow-2xl px-0">
            <img src="https://miqomoxyrymlavjthrzc.supabase.co/storage/v1/object/public/images/Group%20147.png" alt="Musicians performing" class="w-full h-[400px] object-cover top-1 mx-0" />
          </div>

          <div class="absolute bottom-6 right-6 bg-white/95 backdrop-blur-sm rounded-full px-4 py-3 flex items-center space-x-3 shadow-lg transition-colors duration-300 hover:bg-pont-green hover:text-white cursor-pointer group">
                  <div class="bg-pont-rust rounded-full p-2 w-10 h-10 transition-colors duration-300 group-hover:bg-white">
                   
                    <span class="w-6 h-6 fill-current text-white transition-colors duration-300 group-hover:text-pont-green">
                    <i class="fa-solid fa-play ml-0.5"></i>
                    </span>
                  </div>
                  <div (click)="goYoutube()">
                    <div class="font-semibold text-sm">Concert live</div>
                    <div class="text-xs text-gray-600 transition-colors duration-300 group-hover:text-white">
                      Pont Ar Gler
                    </div>
                  </div>
                </div>

        </div>
      </div>
    </div>
  </section>

  <!-- Upcoming Events Section -->
  <section class="py-16 px-4 bg-slate-50 -mt-2" aria-labelledby="upcoming-events-heading">
    <div class="max-w-7xl mx-auto">
      <div class="text-center mb-12">
        <h2 id="upcoming-events-heading" class="text-4xl font-bold text-gray-900 mb-4">Événements à venir</h2>
        <p class="text-lg text-gray-600 max-w-2xl mx-auto">
          Ne manquez pas les concerts, expositions ou lectures, que nous organisons toute l’année !
        </p>
      </div>

      <div class="grid lg:grid-cols-2 gap-8 mb-12">
        <article class="group border-0 shadow-lg bg-white overflow-hidden rounded" *ngFor="let event of limitedEvents; let i = index" [attr.aria-label]="event.title">
          <div class="grid md:grid-cols-5 gap-0 h-full">
            <div class="md:col-span-2 relative h-full">
              <img [src]="event.photo" [alt]="event.title" class="w-full h-full object-cover" loading="lazy" decoding="async" />
              <div class="absolute top-4 left-4">
                <span class="px-3 py-1 rounded-full text-xs font-semibold bg-pont-rust text-white">{{ (event.event_domain || event.edition_type || event.event_type) | titlecase }}</span>
              </div>
              <div class="absolute bottom-4 left-4">
                <div class="flex flex-wrap space-x-2">
                  <span class="px-3 py-1 rounded-full text-xs font-semibold bg-pont-green text-white shadow" *ngFor="let x of event.instruments">{{ x.instrument | titlecase }}</span>
                 </div>
              </div>
            </div>
            <div class="md:col-span-3 p-6 flex flex-col justify-between h-full">
              <div>
                <h5 class="text-sm text-black w-fit">{{ (event.editionDisplay || event.edition || (event.edition_name + ' ' + event.edition_year)) | stripHtml }}</h5>
                <h3 class="text-2xl font-bold text-gray-900">{{ event.title | stripHtml }}</h3>
                <div class="flex flex-wrap gap-1 leading-tight">
                  <h2 class="text-sm lg:text-md font-medium text-pont-rust leading-tight mb-0">{{ event.artistDisplay }}</h2>
                </div>
                <!-- <p class="text-pont-green font-semibold mb-3">{{ concert.artist }}</p> -->
                
                
                <p class="text-gray-600 mb-4 text-xs leading-tight mt-2">{{ (event.teaser || '') | stripHtml | slice:0:120 }}{{ (event.teaser?.length || 0) > 120 ? '…' : '' }}</p>
                <div class="space-y-2 mb-2">
                  <!-- <div class="flex items-center text-gray-700" *ngFor="let show of concert.shows | slice:0:2">
                    <span class="font-medium text-sm">{{ show.date }}</span>
                    <span class="mx-2">•</span>
                    <span class="text-sm">{{ show.time }}</span>
                  </div> -->

                      <div class="space-y-1 text-sm text-gray-700 min-h-16">
            <!-- Period display (isPeriod = true) -->
            <div *ngIf="event.isPeriod">
              <div *ngFor="let p of getVisibleDates(event, i); let idx = index" class="min-w-0 mb-2" [ngClass]="{'line-through text-gray-400': isShowPast(p)}">
                <div class="flex items-center">
                  <i class="fa-regular fa-calendar text-pont-green mr-3" aria-hidden="true"></i>
                  <span class="text-xs">{{ formatPeriodDate(p?.start_date, p?.end_date) }}</span>
                  <span class="mx-2">•</span>
                  <span class="text-xs">{{ (p?.time || '') | slice:0:5 }}</span> 
                 
                </div>
                <div *ngIf="p?.location" class="flex items-center  mt-1">
                  <i class="fa-solid fa-location-dot text-pont-green mr-2"></i>
                  <span class="text-xs">{{ p?.location }}</span>
                </div>
              </div>
            </div>
            <!-- Date display (isPeriod = false) -->
            <div *ngIf="!event.isPeriod">
              <div *ngFor="let d of getVisibleDates(event, i); let idx = index" class="flex items-center min-w-0 mb-1" [ngClass]="{'line-through text-gray-400': isShowPast(d)}">
                <i class="fa-regular fa-calendar text-pont-green mr-3" aria-hidden="true"></i>
                <span class="text-xs">{{ d?.date | date:'dd-MMM' }}</span>
                <span class="mx-2">•</span>
                <span class="text-xs">{{ (d?.time || '') | slice:0:5 }}</span>
                <span class="mx-2">•</span>
                <span class="text-xs truncate max-w-[10rem]"><i class="fa-solid fa-location-dot mr-1"></i> {{ d?.location }}</span>
              </div>
            </div>
            <button *ngIf="getTotalDatesCount(event) > 2" (click)="toggleDates(i)" class="text-pont-green underline text-xs mt-1">
              {{ expandedEvents[i] ? 'Hide all dates' : 'View all dates' }}
            </button>
          </div>

                  <!-- <div class="flex items-center text-gray-700">
                    <i class="fa-solid fa-location-dot text-pont-green mr-3" aria-hidden="true"></i>
                    <span>{{ event.location || 'Location' }}</span>
                  </div> -->
                </div>
              </div>
              <div class="flex items-center justify-between">
                <a [routerLink]="['/events', event.id]" class="bg-pont-rust hover:bg-pont-rust/90 text-white px-6 py-2 rounded" [attr.aria-label]="'View ' + event.title">En savoir plus</a>
              </div>
            </div>
          </div>
        </article>
      </div>

      <ng-container *ngIf="!(eventArray?.length)">
        <p class="text-center text-gray-600">Aucun événement à venir pour le moment. Revenez bientôt.</p>
      </ng-container>

      <div class="text-center">
        <a routerLink="/events" class="border border-pont-rust text-pont-rust hover:bg-pont-rust hover:text-white px-8 py-3 rounded bg-transparent inline-block">
          Voir le programme complet
        </a>
      </div>
    </div>
  </section>

  <!-- Featured Artists Section -->
  <section class="py-16 px-4 bg-cream">
    <div class="max-w-7xl mx-auto">
      <div class="text-center mb-12">
        <h2 class="text-4xl font-bold text-gray-900 mb-4">Artistes à Suivre</h2>
        <p class="text-lg text-gray-600 max-w-2xl mx-auto">
          Découvrez les talents que vous pourrez entendre prochainement à Pont ar Gler !
        </p>
      </div>

      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8 mb-12">
        <div class="group hover:shadow-2xl transition-all duration-300 hover:-translate-y-2 border-0 shadow-lg bg-white rounded overflow-hidden" *ngFor="let artist of artistArray; trackBy: trackByArtistId">
          <div class="relative overflow-hidden">
            <img [src]="artist.photo" [alt]="artist.fname + ' ' + artist.lname" class="w-full h-80 object-cover" />
          </div>
          <div class="p-6">
            <h3 class="font-bold text-xl text-gray-900 mb-2"><a [routerLink]="['/artists', artist.id_artist]" class="hover:text-pont-green">{{ artist.fname | titlecase }} {{ artist.lname | titlecase}}</a></h3>
            <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
              <div class="flex flex-wrap space-x-2">
                @for(x of (artist.instruments ?? []); track x.id_instrument){
              <span class="bg-pont-light-green text-pont-green px-2 py-1 rounded-full text-xs font-medium">{{ x.instrument | titlecase }}</span>
                }
              </div>  
            </div>
            <div class="h-16">
            <p class="text-sm text-gray-600 mb-3">{{ artist.tagline | stripHtml | titlecase}}</p>
</div>
            <div class="flex flex-wrap gap-2 mb-4">
              @for(p of (artist.performance ?? []); track p.id_performance){
              <span class="bg-pont-yellow/20 text-pont-rust px-2 py-1 rounded-full text-[11px] font-medium">{{ p.performance | titlecase }}</span>
              }
            </div>
            <a [routerLink]="['/artists', artist.id_artist]" class="w-full bg-pont-green hover:bg-pont-green/90 text-white text-center block py-2 rounded">Détail</a>
          </div>
        </div>
      </div>

      <div class="text-center">
        <a routerLink="/artists" class="border border-pont-green text-pont-green hover:bg-pont-green hover:text-white px-8 py-3 rounded bg-transparent inline-block">
          Voir tous nos artistes
        </a>
      </div>
    </div>
  </section>

  <!-- Newsletter Section -->
  <section class="py-16 px-4 bg-pont-rust">
    <div class="max-w-2xl mx-auto text-center">
      <h2 class="text-3xl font-bold text-white mb-4">Recevez nos actualités</h2>
      <p class="text-lg text-white mb-8">
        Inscrivez-vous à notre Newletter pour connaître toute la programmation de Pont Ar Gler
      </p>
      <form class="space-y-4" (ngSubmit)="submitNewsletter()">
        <div class="grid md:grid-cols-2 gap-4">
          <input type="text" name="name" [(ngModel)]="newsletter.name" [disabled]="isSubmitting" placeholder="Prénom Nom" class="h-12 px-3 rounded border outline-none" />
          <input type="text" name="phone" [(ngModel)]="newsletter.phone" [disabled]="isSubmitting" placeholder="Téléphone" class="h-12 px-3 rounded border outline-none" />
        </div>
        <input type="email" name="email" [(ngModel)]="newsletter.email" [disabled]="isSubmitting" required placeholder="Adresse email" class="h-12 px-3 rounded border w-full outline-none" />
        <button type="submit" [disabled]="isSubmitting" [attr.aria-busy]="isSubmitting ? 'true' : 'false'" class="bg-white text-pont-rust px-8 py-3 text-lg rounded inline-flex items-center justify-center min-w-56">
          <span *ngIf="isSubmitting" class="inline-flex items-center">
            <i class="fa-solid fa-circle-notch fa-spin mr-2"></i>
            Souscrivez...
          </span>
          <span *ngIf="!isSubmitting">Souscrivez à la Newsletter</span>
        </button>
      </form>
    </div>
  </section>
</div>
